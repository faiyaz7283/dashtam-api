# Casbin RBAC Model Configuration
#
# This defines the PERM (Policy, Effect, Request, Matchers) metamodel
# for role-based access control with role hierarchy.
#
# Reference:
#   - docs/architecture/authorization-architecture.md
#   - https://casbin.org/docs/syntax-for-models
#
# Role Hierarchy:
#   admin > user > readonly
#   (admin inherits user, user inherits readonly)

[request_definition]
# Request format: subject (user_id), object (resource), action
r = sub, obj, act

[policy_definition]
# Policy format: subject (role), object (resource), action
p = sub, obj, act

[role_definition]
# Role grouping: user/role -> parent_role
# Used for both user-to-role and role-to-role (hierarchy)
g = _, _

[policy_effect]
# Allow if any matching policy allows
e = some(where (p.eft == allow))

[matchers]
# Match if:
# 1. User has role (via g function) that matches policy subject
# 2. Resource matches
# 3. Action matches
m = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act
